<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Rest (sihl.Sihl.Web.Rest)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">sihl</a> &#x00BB; <a href="../../index.html">Sihl</a> &#x00BB; <a href="../index.html">Web</a> &#x00BB; Rest</nav><h1>Module <code>Web.Rest</code></h1><p>This module allows you to build RESTful web pages quickly.</p></header><dl><dt class="spec type" id="type-action"><a href="#type-action" class="anchor"></a><code><span class="keyword">type</span> action</code> = <code>[ </code><table class="variant"><tr id="type-action.Index" class="anchored"><td class="def constructor"><a href="#type-action.Index" class="anchor"></a><code>| </code><code>`Index</code></td></tr><tr id="type-action.Create" class="anchored"><td class="def constructor"><a href="#type-action.Create" class="anchor"></a><code>| </code><code>`Create</code></td></tr><tr id="type-action.New" class="anchored"><td class="def constructor"><a href="#type-action.New" class="anchor"></a><code>| </code><code>`New</code></td></tr><tr id="type-action.Edit" class="anchored"><td class="def constructor"><a href="#type-action.Edit" class="anchor"></a><code>| </code><code>`Edit</code></td></tr><tr id="type-action.Show" class="anchored"><td class="def constructor"><a href="#type-action.Show" class="anchor"></a><code>| </code><code>`Show</code></td></tr><tr id="type-action.Update" class="anchored"><td class="def constructor"><a href="#type-action.Update" class="anchor"></a><code>| </code><code>`Update</code></td></tr><tr id="type-action.Destroy" class="anchored"><td class="def constructor"><a href="#type-action.Destroy" class="anchor"></a><code>| </code><code>`Destroy</code></td></tr></table><code> ]</code></dt><dt class="spec type" id="type-query"><a href="#type-query" class="anchor"></a><code><span class="keyword">type</span> query</code><code> = <a href="../../../Sihl__Web_rest/Query/index.html#type-t">Sihl__.Web_rest.Query.t</a></code><code> = </code><code>{</code><table class="record"><tr id="type-query.filter" class="anchored"><td class="def field"><a href="#type-query.filter" class="anchor"></a><code>filter : <span>string option</span>;</code></td></tr><tr id="type-query.limit" class="anchored"><td class="def field"><a href="#type-query.limit" class="anchor"></a><code>limit : <span>int option</span>;</code></td></tr><tr id="type-query.offset" class="anchored"><td class="def field"><a href="#type-query.offset" class="anchor"></a><code>offset : <span>int option</span>;</code></td></tr><tr id="type-query.sort" class="anchored"><td class="def field"><a href="#type-query.sort" class="anchor"></a><code>sort : <span><span>[ `Desc <span>| `Asc</span> ]</span> option</span>;</code></td></tr></table><code>}</code></dt><dd><p>A <code>query</code> describes the search terms of an <code>`Index</code> action and it represents a partial view on a collection that is sorted and filtered.</p></dd></dl><dl><dt class="spec value" id="val-of_request"><a href="#val-of_request" class="anchor"></a><code><span class="keyword">val</span> of_request : <a href="../index.html#module-Request">Request</a>.t <span>&#45;&gt;</span> <a href="index.html#type-query">query</a></code></dt><dd><p><code>of_request request</code> returns the query by parsing the query string of the <code>request</code>.</p></dd></dl><dl><dt class="spec value" id="val-to_query_string"><a href="#val-to_query_string" class="anchor"></a><code><span class="keyword">val</span> to_query_string : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>to_query_string query</code> returns the query string representation of a <code>query</code> that can be used safely in URIs. Note that the question mark <code>?</code> is also part of it.</p></dd></dl><dl><dt class="spec value" id="val-next_page"><a href="#val-next_page" class="anchor"></a><code><span class="keyword">val</span> next_page : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="index.html#type-query">query</a> option</span></code></dt><dd><p><code>next_page query total</code> returns a query that represents the result of the next page given the <code>query</code> of the current page.</p><p><code>total</code> is the total number of items in the collection.</p><p><code>None</code> is returned if the current page is already the last page and there is no next page.</p></dd></dl><dl><dt class="spec value" id="val-previous_page"><a href="#val-previous_page" class="anchor"></a><code><span class="keyword">val</span> previous_page : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> <span><a href="index.html#type-query">query</a> option</span></code></dt><dd><p><code>previous_page query</code> returns a query that represents the previous page given the <code>query</code> of the current page.</p><p><code>None</code> is returned if the current page is the first page and there is no previous page.</p></dd></dl><dl><dt class="spec value" id="val-last_page"><a href="#val-last_page" class="anchor"></a><code><span class="keyword">val</span> last_page : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="index.html#type-query">query</a> option</span></code></dt><dd><p><code>last_page query total</code> returns a query that represents the result of the last page given the <code>query</code> of the current page.</p><p><code>total</code> is the total number of items in the collection.</p><p><code>None</code> is returned if the current page is already the last page.</p></dd></dl><dl><dt class="spec value" id="val-first_page"><a href="#val-first_page" class="anchor"></a><code><span class="keyword">val</span> first_page : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> <span><a href="index.html#type-query">query</a> option</span></code></dt><dd><p><code>first_page query total</code> returns a query that represents the result of the first page given the <code>query</code> of the current page.</p><p><code>None</code> is returned if the current page is already the first page.</p></dd></dl><dl><dt class="spec value" id="val-query_filter"><a href="#val-query_filter" class="anchor"></a><code><span class="keyword">val</span> query_filter : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>query_filter query</code> returns the string representation of the filter keyword if it exists.</p></dd></dl><dl><dt class="spec value" id="val-query_sort"><a href="#val-query_sort" class="anchor"></a><code><span class="keyword">val</span> query_sort : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>query_sort query</code> returns the string representation of the sort keyword if it exists.</p></dd></dl><dl><dt class="spec value" id="val-query_limit"><a href="#val-query_limit" class="anchor"></a><code><span class="keyword">val</span> query_limit : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>query_limit query</code> returns the string representation of the limit if it exists.</p></dd></dl><dl><dt class="spec value" id="val-query_offset"><a href="#val-query_offset" class="anchor"></a><code><span class="keyword">val</span> query_offset : <a href="index.html#type-query">query</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>query_offset query</code> returns the string representation of the offset if it exists.</p></dd></dl><dl><dt class="spec type" id="type-form"><a href="#type-form" class="anchor"></a><code><span class="keyword">type</span> form</code><code> = <span><span>(string * <span>string option</span> * <span>string option</span>)</span> list</span></code></dt><dd><p><code>form</code> represents a validated and decoded form. One element consists of <code>(name, input, error)</code>.</p><p><code>name</code> is the schema field name and the HTML input name.</p><p><code>input</code> is the input of the form that was submitted, it might not be present. Use it to restore form values after it was submitted and validation or decoding failed.</p><p><code>error</code> is the error message of the validation or decoding.</p></dd></dl><dl><dt class="spec value" id="val-find_form"><a href="#val-find_form" class="anchor"></a><code><span class="keyword">val</span> find_form : string <span>&#45;&gt;</span> <a href="index.html#type-form">form</a> <span>&#45;&gt;</span> <span>string option</span> * <span>string option</span></code></dt><dd><p><code>find_form name form</code> returns the <code>(value, error)</code> of a <code>form</code> input element with the <code>name</code>.</p><p>The <code>value</code> is the submitted value of the input element. The value is set even if the submitted form failed to decode or validate. Use the submitted values to populate the form that can be fixed and re-submitted by the user.</p><p>The <code>error</code> message comes from either the decoding, validation or CRUD service. It can be shown to the user.</p></dd></dl><dl><dt class="spec module-type" id="module-type-SERVICE"><a href="#module-type-SERVICE" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-SERVICE/index.html">SERVICE</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>SERVICE</code> interface has to be implemented by a CRUD service that drives the resource with its business logic.</p></dd></dl><dl><dt class="spec module-type" id="module-type-VIEW"><a href="#module-type-VIEW" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-VIEW/index.html">VIEW</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>VIEW</code> interface needs to be implemented by a module that renders HTML.</p></dd></dl><dl><dt class="spec module-type" id="module-type-CONTROLLER"><a href="#module-type-CONTROLLER" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-CONTROLLER/index.html">CONTROLLER</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A module of type <code>CONTROLLER</code> can be used to create a resource with <a href="index.html#val-resource_of_controller"><code>resource_of_controller</code></a>. Use a controller instead of a service and a view if you need low level control.</p></dd></dl><dl><dt class="spec value" id="val-resource_of_service"><a href="#val-resource_of_service" class="anchor"></a><code><span class="keyword">val</span> resource_of_service : <span>?&#8288;only:<span><a href="index.html#type-action">action</a> list</span></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span class="type-var">'meta</span>, <span class="type-var">'ctor</span>, <span class="type-var">'resource</span>)</span> Conformist.t</span> <span>&#45;&gt;</span> <span>view:<span>(<span class="keyword">module</span> <a href="module-type-VIEW/index.html">VIEW</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-VIEW/index.html#type-t">t</a> = <span class="type-var">'resource</span>)</span></span> <span>&#45;&gt;</span> <span>(<span class="keyword">module</span> <a href="module-type-SERVICE/index.html">SERVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-SERVICE/index.html#type-t">t</a> = <span class="type-var">'resource</span>)</span> <span>&#45;&gt;</span> <span><a href="../index.html#type-router">router</a> list</span></code></dt><dd><p><code>resource_of_service ?only name schema ~view service</code> returns a list of routers that can be combined with <a href="../index.html#val-choose"><code>choose</code></a> that represent a resource.</p><p>A resource <code>pizzas</code> creates following 7 routers:</p><pre>        GET       /pizzas          `Index  Display a list of all pizzas
        GET       /pizzas/new      `New    Return an HTML form for creating a new pizza
        POST      /pizzas          `Create Create a new pizza
        GET       /pizzas/:id      `Show   Display a specific pizza
        GET       /pizzas/:id/edit `Edit   Return an HTML form for editing a pizza
        PATCH/PUT /pizzas/:id      `Update Update a specific pizza
        DELETE    /pizzas/:id      `Delete Delete a specific pizza</pre><p><code>only</code> is an optional list of <a href="index.html#type-action"><code>action</code></a>s. If only is set, routers are created only for the actions listed.</p><p><code>name</code> is the name of the resource. It is good practice to use plural as the name is used to build the resource path of the URL.</p><p><code>schema</code> is the conformist schema of the resource.</p><p><code>view</code> is the view service of type <a href="module-type-VIEW/index.html"><code>VIEW</code></a> of the resource. The view renders HTML.</p><p><code>service</code> is the underlying CRUD service of type <a href="module-type-SERVICE/index.html"><code>SERVICE</code></a> of the resource.</p></dd></dl><dl><dt class="spec value" id="val-resource_of_controller"><a href="#val-resource_of_controller" class="anchor"></a><code><span class="keyword">val</span> resource_of_controller : <span>?&#8288;only:<span><a href="index.html#type-action">action</a> list</span></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span class="type-var">'meta</span>, <span class="type-var">'ctor</span>, <span class="type-var">'resource</span>)</span> Conformist.t</span> <span>&#45;&gt;</span> <span>(<span class="keyword">module</span> <a href="module-type-CONTROLLER/index.html">CONTROLLER</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-CONTROLLER/index.html#type-t">t</a> = <span class="type-var">'resource</span>)</span> <span>&#45;&gt;</span> <span><a href="../index.html#type-router">router</a> list</span></code></dt><dd><p><code>resource_of_controller ?only name schema controller</code> returns the same list of routers as <a href="index.html#val-resource_of_service"><code>resource_of_service</code></a>. <code>resource_of_controller</code> takes one module of type <a href="module-type-CONTROLLER/index.html"><code>CONTROLLER</code></a> instead of a view and a service.</p><p>If you implement your own controller you have to do all the wiring yourself, but you gain more control.</p></dd></dl></div></body></html>