<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>2-TokenService (sihl-user.Sihl_user__.Password_reset.Make.2-TokenService)</title><link rel="stylesheet" href="../../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">sihl-user</a> &#x00BB; <a href="../../../index.html">Sihl_user__</a> &#x00BB; <a href="../../index.html">Password_reset</a> &#x00BB; <a href="../index.html">Make</a> &#x00BB; 2-TokenService</nav><h1>Parameter <code>Make.2-TokenService</code></h1></header><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <span>?&#8288;secret:string</span> <span>&#45;&gt;</span> <span>?&#8288;expires_in:<a href="../../../../../sihl/Sihl__/Core_time/index.html#type-duration">Sihl__.Core_time.duration</a></span> <span>&#45;&gt;</span> <span><span>(string * string)</span> list</span> <span>&#45;&gt;</span> <span>string Lwt.t</span></code></dt><dd><p><code>create ?expires_in ?secret data</code> returns a token that expires in <code>expires_in</code> with the associated data <code>data</code>. If no <code>expires_in</code> is set, the default is 7 days. An optional secret <code>secret</code> can be provided for the token signature, by default `SIHL_SECRET` is used.</p></dd></dl><dl><dt class="spec value" id="val-read"><a href="#val-read" class="anchor"></a><code><span class="keyword">val</span> read : <span>?&#8288;secret:string</span> <span>&#45;&gt;</span> <span>?&#8288;force:unit</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>k:string</span> <span>&#45;&gt;</span> <span><span>string option</span> Lwt.t</span></code></dt><dd><p><code>read ?secret ?force token k</code> returns the value that is associated with the key <code>k</code> in the token <code>token</code>. If <code>force</code> is set, the value is read and returned even if the token is expired, deactivated and the signature is invalid. If the token is completely invalid and can not be read, no value is returned. An optional secret <code>secret</code> can be provided to override the default `SIHL_SECRET`.</p></dd></dl><dl><dt class="spec value" id="val-read_all"><a href="#val-read_all" class="anchor"></a><code><span class="keyword">val</span> read_all : <span>?&#8288;secret:string</span> <span>&#45;&gt;</span> <span>?&#8288;force:unit</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span><span><span>(string * string)</span> list</span> option</span> Lwt.t</span></code></dt><dd><p><code>read_all ?secret ?force token</code> returns all key-value pairs associated with the token <code>token</code>. If <code>force</code> is set, the values are read and returned even if the token is expired, deactivated and the signature is invalid. If the token is completely invalid and can not be read, no value is returned. An optional secret <code>secret</code> can be provided to override the default `SIHL_SECRET`.</p></dd></dl><dl><dt class="spec value" id="val-verify"><a href="#val-verify" class="anchor"></a><code><span class="keyword">val</span> verify : <span>?&#8288;secret:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>verify ?secret token</code> returns true if the token has a valid structure and the signature is valid, false otherwise. An optional secret <code>secret</code> can be provided to override the default `SIHL_SECRET`.</p></dd></dl><dl><dt class="spec value" id="val-deactivate"><a href="#val-deactivate" class="anchor"></a><code><span class="keyword">val</span> deactivate : string <span>&#45;&gt;</span> <span>unit Lwt.t</span></code></dt><dd><p><code>deactivate token</code> deactivates the token. Depending on the backend of the token service a blacklist is used to store the token.</p></dd></dl><dl><dt class="spec value" id="val-activate"><a href="#val-activate" class="anchor"></a><code><span class="keyword">val</span> activate : string <span>&#45;&gt;</span> <span>unit Lwt.t</span></code></dt><dd><p><code>activate token</code> re-activates the token. Depending on the backend of the token service a blacklist is used to store the token.</p></dd></dl><dl><dt class="spec value" id="val-is_active"><a href="#val-is_active" class="anchor"></a><code><span class="keyword">val</span> is_active : string <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>is_active token</code> returns true if the token is active, false if the token was deactivated. An expired token or a token that has an invalid signature is not necessarily inactive.</p></dd></dl><dl><dt class="spec value" id="val-is_expired"><a href="#val-is_expired" class="anchor"></a><code><span class="keyword">val</span> is_expired : <span>?&#8288;secret:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>is_expired token</code> returns true if the token is expired, false otherwise. An optional secret <code>secret</code> can be provided to override the default `SIHL_SECRET`.</p></dd></dl><dl><dt class="spec value" id="val-is_valid"><a href="#val-is_valid" class="anchor"></a><code><span class="keyword">val</span> is_valid : <span>?&#8288;secret:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>is_valid token</code> returns true if the token is not expired, active and the signature is valid and false otherwise. A valid token can safely be used. An optional secret <code>secret</code> can be provided to override the default `SIHL_SECRET`.</p></dd></dl><dl><dt class="spec value" id="val-register"><a href="#val-register" class="anchor"></a><code><span class="keyword">val</span> register : unit <span>&#45;&gt;</span> <a href="../../../../../sihl/Sihl__Core_container/Service/index.html#type-t">Sihl__.Core_container.Service.t</a></code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../../sihl/Sihl__Core_container/Service/index.html#module-type-Sig">Sihl__.Core_container.Service.Sig</a></code></span></summary><dl><dt class="spec value" id="val-lifecycle"><a href="#val-lifecycle" class="anchor"></a><code><span class="keyword">val</span> lifecycle : <a href="../../../../../sihl/Sihl__/Core_container/index.html#type-lifecycle">Sihl__.Core_container.lifecycle</a></code></dt></dl></details></div></div></div></div></body></html>