<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>InMemory (sihl-queue.Sihl_queue.InMemory)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">sihl-queue</a> &#x00BB; <a href="../index.html">Sihl_queue</a> &#x00BB; InMemory</nav><h1>Module <code>Sihl_queue.InMemory</code></h1></header><div><div class="spec include"><div class="doc"><p>The in-memory queue is not a persistent queue. If the process goes down, all jobs are lost. It doesn't support locking and the queue is unbounded, use it only for testing!</p><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../sihl/Sihl__/Contract_queue/index.html#module-type-Sig">Sihl.Contract.Queue.Sig</a></code></span></summary><dl><dt class="spec value" id="val-router"><a href="#val-router" class="anchor"></a><code><span class="keyword">val</span> router : <span>?&#8288;back:string</span> <span>&#45;&gt;</span> <span>?&#8288;theme:<span>[ <span>`Custom of string</span> <span>| `Light</span> <span>| `Dark</span> ]</span></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../../../sihl/Sihl/Web/index.html#type-router">Sihl.Web.router</a></code></dt><dd><p><code>router ?back scope</code> returns a router that can be passed to the web server to serve the job queue dashboard.</p><p><code>back</code> is an optional URL which renders a back button on the dashboard. Use this to provide your admin user a way to easily exit the dashboard. By default, no URL is provided and no back button is shown.</p><p><code>scope</code> is the URL path under which the dashboard can be accessed. It is common to have some admin UI under <code>/admin</code>, the job queue dashboard could be available under <code>/admin/queue</code>.</p><p>You can use HTMX by setting <code>HTMX_SCRIPT_URL</code> to the URL of the HTMX JavaScript file that is then embedded into the dashboard using the &lt;script&gt; tag in the page body. HTMX is used to add dynamic features such as auto-refresh. The dashboard is perfectly usable without it. By default, HTMX is not used.</p></dd></dl><dl><dt class="spec value" id="val-dispatch"><a href="#val-dispatch" class="anchor"></a><code><span class="keyword">val</span> dispatch : <span>?&#8288;delay:Ptime.span</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../../../sihl/Sihl/Contract/Queue/index.html#type-job">Sihl.Contract.Queue.job</a></span> <span>&#45;&gt;</span> <span>unit Lwt.t</span></code></dt><dd><p><code>dispatch ?delay input job</code> queues <code>job</code> for later processing and returns <code>unit Lwt.t</code> once the job has been queued.</p><p>An optional <code>delay</code> determines the amount of time from now (when dispatch is called) up until the job can be run. If no delay is specified, the job is processed as soon as possible.</p><p><code>input</code> is the input of the <code>handle</code> function which is used for job processing.</p></dd></dl><dl><dt class="spec value" id="val-dispatch_all"><a href="#val-dispatch_all" class="anchor"></a><code><span class="keyword">val</span> dispatch_all : <span>?&#8288;delay:Ptime.span</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../../../sihl/Sihl/Contract/Queue/index.html#type-job">Sihl.Contract.Queue.job</a></span> <span>&#45;&gt;</span> <span>unit Lwt.t</span></code></dt><dd><p><code>dispatch_all ?delay inputs jobs</code> queues all <code>jobs</code> for later processing and returns <code>unit Lwt.t</code> once all the jobs has been queued. The jobs are put onto the queue in reverse order. The first job in the list of <code>jobs</code> is put onto the queue last, which means it gets processed first.</p><p>If the queue backend supports transactions, <code>dispatch_all</code> guarantees that either none or all jobs are queued.</p><p>An optional <code>delay</code> determines the amount of time from now (when dispatch is called) up until the jobs can be run. If no delay is specified, the jobs are processed as soon as possible.</p><p><code>inputs</code> is the input of the <code>handle</code> function. It is a list of <code>'a</code>, one for each <code>'a job</code> instance.</p></dd></dl><dl><dt class="spec value" id="val-register_jobs"><a href="#val-register_jobs" class="anchor"></a><code><span class="keyword">val</span> register_jobs : <span><a href="../../../sihl/Sihl/Contract/Queue/index.html#type-job'">Sihl.Contract.Queue.job'</a> list</span> <span>&#45;&gt;</span> <span>unit Lwt.t</span></code></dt><dd><p><code>register_jobs jobs</code> registers jobs that can be dispatched later on.</p><p>Only registered jobs can be dispatched. Dispatching a job that was not registered does nothing.</p></dd></dl><dl><dt class="spec value" id="val-register"><a href="#val-register" class="anchor"></a><code><span class="keyword">val</span> register : <span>?&#8288;jobs:<span><a href="../../../sihl/Sihl/Contract/Queue/index.html#type-job'">Sihl.Contract.Queue.job'</a> list</span></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="../../../sihl/Sihl__/Core_service/index.html#type-t">Sihl__.Core_container.Service.t</a></code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../sihl/Sihl__/Core_service/index.html#module-type-Sig">Sihl__.Core_container.Service.Sig</a></code></span></summary><dl><dt class="spec value" id="val-lifecycle"><a href="#val-lifecycle" class="anchor"></a><code><span class="keyword">val</span> lifecycle : <a href="../../../sihl/Sihl__/Core_lifecycle/index.html#type-lifecycle">Sihl__.Core_lifecycle.lifecycle</a></code></dt></dl></details></div></div></div></details></div></div></div></div></body></html>